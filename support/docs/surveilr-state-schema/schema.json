{"name":"Resource Surveillance State Schema","desc":"","tables":[{"name":"device","type":"table","comment":"Identity, network segmentation, and sysinfo for devices on which uniform_resource are found","columns":[{"name":"device_id","type":"VARCHAR","nullable":false,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isVarChar\":true}"},{"name":"name","type":"TEXT","nullable":false,"default":null,"comment":"unique device identifier (defaults to hostname)"},{"name":"state","type":"TEXT","nullable":false,"default":null,"comment":"should be \"SINGLETON\" if only one state is allowed, or other tags if multiple states are allowed"},{"name":"boundary","type":"TEXT","nullable":false,"default":null,"comment":"can be IP address, VLAN, or any other device name differentiator"},{"name":"segmentation","type":"TEXT","nullable":true,"default":null,"comment":"zero trust or other network segmentation"},{"name":"state_sysinfo","type":"TEXT","nullable":true,"default":null,"comment":"any sysinfo or other state data that is specific to this device (mutable)"},{"name":"elaboration","type":"TEXT","nullable":true,"default":null,"comment":"any elaboration needed for the device (mutable)"},{"name":"created_at","type":"TIMESTAMP","nullable":true,"default":"CURRENT_TIMESTAMP","comment":""},{"name":"created_by","type":"TEXT","nullable":true,"default":"'UNKNOWN'","comment":""},{"name":"updated_at","type":"TIMESTAMP","nullable":true,"default":null,"comment":""},{"name":"updated_by","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"deleted_at","type":"TIMESTAMP","nullable":true,"default":null,"comment":""},{"name":"deleted_by","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"activity_log","type":"TEXT","nullable":true,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isJsonSqlDomain\":true}"}],"indexes":[{"name":"idx_device__name__state","def":"CREATE INDEX \"idx_device__name__state\" ON \"device\"(\"name\", \"state\")","table":"device","columns":["name","state"],"comment":""},{"name":"sqlite_autoindex_device_2","def":"UNIQUE (name, state, boundary)","table":"device","columns":["name","state","boundary"],"comment":""},{"name":"sqlite_autoindex_device_1","def":"PRIMARY KEY (device_id)","table":"device","columns":["device_id"],"comment":""}],"constraints":[{"name":"device_id","type":"PRIMARY KEY","def":"PRIMARY KEY (device_id)","table":"device","referenced_table":null,"columns":["device_id"],"referenced_columns":null,"comment":""},{"name":"sqlite_autoindex_device_2","type":"UNIQUE","def":"UNIQUE (name, state, boundary)","table":"device","referenced_table":null,"columns":["name","state","boundary"],"referenced_columns":null,"comment":""},{"name":"sqlite_autoindex_device_1","type":"PRIMARY KEY","def":"PRIMARY KEY (device_id)","table":"device","referenced_table":null,"columns":["device_id"],"referenced_columns":null,"comment":""},{"name":"-","type":"CHECK","def":"CHECK(json_valid(state))","table":"device","referenced_table":null,"columns":["state"],"referenced_columns":null,"comment":""},{"name":"-","type":"CHECK","def":"CHECK(json_valid(segmentation) OR segmentation IS NULL)","table":"device","referenced_table":null,"columns":["segmentation"],"referenced_columns":null,"comment":""},{"name":"-","type":"CHECK","def":"CHECK(json_valid(state_sysinfo) OR state_sysinfo IS NULL)","table":"device","referenced_table":null,"columns":["state","state_sysinfo"],"referenced_columns":null,"comment":""},{"name":"-","type":"CHECK","def":"CHECK(json_valid(elaboration) OR elaboration IS NULL)","table":"device","referenced_table":null,"columns":["elaboration"],"referenced_columns":null,"comment":""}],"triggers":[],"def":"CREATE TABLE \"device\" (\n    \"device_id\" VARCHAR PRIMARY KEY NOT NULL,\n    \"name\" TEXT NOT NULL,\n    \"state\" TEXT CHECK(json_valid(state)) NOT NULL,\n    \"boundary\" TEXT NOT NULL,\n    \"segmentation\" TEXT CHECK(json_valid(segmentation) OR segmentation IS NULL),\n    \"state_sysinfo\" TEXT CHECK(json_valid(state_sysinfo) OR state_sysinfo IS NULL),\n    \"elaboration\" TEXT CHECK(json_valid(elaboration) OR elaboration IS NULL),\n    \"created_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"created_by\" TEXT DEFAULT 'UNKNOWN',\n    \"updated_at\" TIMESTAMP,\n    \"updated_by\" TEXT,\n    \"deleted_at\" TIMESTAMP,\n    \"deleted_by\" TEXT,\n    \"activity_log\" TEXT,\n    UNIQUE(\"name\", \"state\", \"boundary\")\n)"},{"name":"behavior","type":"table","comment":"Behaviors are configuration \"presets\" that can be used to drive\napplication operations at runtime. For example, ingest behaviors\ninclude configs that indicate which files to ignore, which to\nscan, when to load content, etc. This is more convenient than\ncreating\n\nbehavior has a foreign key reference to the device table since\nbehaviors might be device-specific.","columns":[{"name":"behavior_id","type":"VARCHAR","nullable":false,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isVarChar\":true}"},{"name":"device_id","type":"VARCHAR","nullable":false,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isVarChar\":true}"},{"name":"behavior_name","type":"TEXT","nullable":false,"default":null,"comment":"Arbitrary but unique per-device behavior name (e.g. ingest::xyz)"},{"name":"behavior_conf_json","type":"TEXT","nullable":false,"default":null,"comment":"Configuration, settings, parameters, etc. describing the behavior (JSON, behavior-dependent)"},{"name":"assurance_schema_id","type":"VARCHAR","nullable":true,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isVarChar\":true}"},{"name":"governance","type":"TEXT","nullable":true,"default":null,"comment":"Descriptions or other \"governance\" details (JSON, behavior-dependent)"},{"name":"created_at","type":"TIMESTAMP","nullable":true,"default":"CURRENT_TIMESTAMP","comment":""},{"name":"created_by","type":"TEXT","nullable":true,"default":"'UNKNOWN'","comment":""},{"name":"updated_at","type":"TIMESTAMP","nullable":true,"default":null,"comment":""},{"name":"updated_by","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"deleted_at","type":"TIMESTAMP","nullable":true,"default":null,"comment":""},{"name":"deleted_by","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"activity_log","type":"TEXT","nullable":true,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isJsonSqlDomain\":true}"}],"indexes":[{"name":"sqlite_autoindex_behavior_2","def":"UNIQUE (device_id, behavior_name)","table":"behavior","columns":["device_id","behavior_name"],"comment":""},{"name":"sqlite_autoindex_behavior_1","def":"PRIMARY KEY (behavior_id)","table":"behavior","columns":["behavior_id"],"comment":""}],"constraints":[{"name":"behavior_id","type":"PRIMARY KEY","def":"PRIMARY KEY (behavior_id)","table":"behavior","referenced_table":null,"columns":["behavior_id"],"referenced_columns":null,"comment":""},{"name":"- (Foreign key ID: 0)","type":"FOREIGN KEY","def":"FOREIGN KEY (assurance_schema_id) REFERENCES assurance_schema (assurance_schema_id) ON UPDATE NO ACTION ON DELETE NO ACTION MATCH NONE","table":"behavior","referenced_table":"assurance_schema","columns":["assurance_schema_id"],"referenced_columns":["assurance_schema_id"],"comment":""},{"name":"- (Foreign key ID: 1)","type":"FOREIGN KEY","def":"FOREIGN KEY (device_id) REFERENCES device (device_id) ON UPDATE NO ACTION ON DELETE NO ACTION MATCH NONE","table":"behavior","referenced_table":"device","columns":["device_id"],"referenced_columns":["device_id"],"comment":""},{"name":"sqlite_autoindex_behavior_2","type":"UNIQUE","def":"UNIQUE (device_id, behavior_name)","table":"behavior","referenced_table":null,"columns":["device_id","behavior_name"],"referenced_columns":null,"comment":""},{"name":"sqlite_autoindex_behavior_1","type":"PRIMARY KEY","def":"PRIMARY KEY (behavior_id)","table":"behavior","referenced_table":null,"columns":["behavior_id"],"referenced_columns":null,"comment":""},{"name":"-","type":"CHECK","def":"CHECK(json_valid(behavior_conf_json))","table":"behavior","referenced_table":null,"columns":["behavior_conf_json"],"referenced_columns":null,"comment":""},{"name":"-","type":"CHECK","def":"CHECK(json_valid(governance) OR governance IS NULL)","table":"behavior","referenced_table":null,"columns":["governance"],"referenced_columns":null,"comment":""}],"triggers":[],"def":"CREATE TABLE \"behavior\" (\n    \"behavior_id\" VARCHAR PRIMARY KEY NOT NULL,\n    \"device_id\" VARCHAR NOT NULL,\n    \"behavior_name\" TEXT NOT NULL,\n    \"behavior_conf_json\" TEXT CHECK(json_valid(behavior_conf_json)) NOT NULL,\n    \"assurance_schema_id\" VARCHAR,\n    \"governance\" TEXT CHECK(json_valid(governance) OR governance IS NULL),\n    \"created_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"created_by\" TEXT DEFAULT 'UNKNOWN',\n    \"updated_at\" TIMESTAMP,\n    \"updated_by\" TEXT,\n    \"deleted_at\" TIMESTAMP,\n    \"deleted_by\" TEXT,\n    \"activity_log\" TEXT,\n    FOREIGN KEY(\"device_id\") REFERENCES \"device\"(\"device_id\"),\n    FOREIGN KEY(\"assurance_schema_id\") REFERENCES \"assurance_schema\"(\"assurance_schema_id\"),\n    UNIQUE(\"device_id\", \"behavior_name\")\n)"},{"name":"ur_ingest_session","type":"table","comment":"Immutable ingestion sessions represents any \"discovery\" or \"walk\" operation.  This could be a device file system scan or any other resource discovery  session. Each time a discovery operation starts, a record is created.  ur_ingest_session has a foreign key reference to the device table so that the  same device can be used for multiple ingest sessions but also the ingest  sessions can be merged across workstations / servers for easier detection  of changes and similaries between file systems on different devices.","columns":[{"name":"ur_ingest_session_id","type":"VARCHAR","nullable":false,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isVarChar\":true}"},{"name":"device_id","type":"VARCHAR","nullable":false,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isVarChar\":true}"},{"name":"behavior_id","type":"VARCHAR","nullable":true,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isVarChar\":true}"},{"name":"behavior_json","type":"TEXT","nullable":true,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isJsonText\":true}"},{"name":"ingest_started_at","type":"TIMESTAMP","nullable":false,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isDateSqlDomain\":true,\"isDateTime\":true}"},{"name":"ingest_finished_at","type":"TIMESTAMP","nullable":true,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isDateSqlDomain\":true,\"isDateTime\":true}"},{"name":"elaboration","type":"TEXT","nullable":true,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isJsonText\":true}"},{"name":"created_at","type":"TIMESTAMP","nullable":true,"default":"CURRENT_TIMESTAMP","comment":""},{"name":"created_by","type":"TEXT","nullable":true,"default":"'UNKNOWN'","comment":""},{"name":"updated_at","type":"TIMESTAMP","nullable":true,"default":null,"comment":""},{"name":"updated_by","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"deleted_at","type":"TIMESTAMP","nullable":true,"default":null,"comment":""},{"name":"deleted_by","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"activity_log","type":"TEXT","nullable":true,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isJsonSqlDomain\":true}"}],"indexes":[{"name":"sqlite_autoindex_ur_ingest_session_2","def":"UNIQUE (device_id, created_at)","table":"ur_ingest_session","columns":["device_id","created_at"],"comment":""},{"name":"sqlite_autoindex_ur_ingest_session_1","def":"PRIMARY KEY (ur_ingest_session_id)","table":"ur_ingest_session","columns":["ur_ingest_session_id"],"comment":""}],"constraints":[{"name":"ur_ingest_session_id","type":"PRIMARY KEY","def":"PRIMARY KEY (ur_ingest_session_id)","table":"ur_ingest_session","referenced_table":null,"columns":["ur_ingest_session_id"],"referenced_columns":null,"comment":""},{"name":"- (Foreign key ID: 0)","type":"FOREIGN KEY","def":"FOREIGN KEY (behavior_id) REFERENCES behavior (behavior_id) ON UPDATE NO ACTION ON DELETE NO ACTION MATCH NONE","table":"ur_ingest_session","referenced_table":"behavior","columns":["behavior_id"],"referenced_columns":["behavior_id"],"comment":""},{"name":"- (Foreign key ID: 1)","type":"FOREIGN KEY","def":"FOREIGN KEY (device_id) REFERENCES device (device_id) ON UPDATE NO ACTION ON DELETE NO ACTION MATCH NONE","table":"ur_ingest_session","referenced_table":"device","columns":["device_id"],"referenced_columns":["device_id"],"comment":""},{"name":"sqlite_autoindex_ur_ingest_session_2","type":"UNIQUE","def":"UNIQUE (device_id, created_at)","table":"ur_ingest_session","referenced_table":null,"columns":["device_id","created_at"],"referenced_columns":null,"comment":""},{"name":"sqlite_autoindex_ur_ingest_session_1","type":"PRIMARY KEY","def":"PRIMARY KEY (ur_ingest_session_id)","table":"ur_ingest_session","referenced_table":null,"columns":["ur_ingest_session_id"],"referenced_columns":null,"comment":""},{"name":"-","type":"CHECK","def":"CHECK(json_valid(behavior_json) OR behavior_json IS NULL)","table":"ur_ingest_session","referenced_table":null,"columns":["behavior_json"],"referenced_columns":null,"comment":""},{"name":"-","type":"CHECK","def":"CHECK(json_valid(elaboration) OR elaboration IS NULL)","table":"ur_ingest_session","referenced_table":null,"columns":["elaboration"],"referenced_columns":null,"comment":""}],"triggers":[],"def":"CREATE TABLE \"ur_ingest_session\" (\n    \"ur_ingest_session_id\" VARCHAR PRIMARY KEY NOT NULL,\n    \"device_id\" VARCHAR NOT NULL,\n    \"behavior_id\" VARCHAR,\n    \"behavior_json\" TEXT CHECK(json_valid(behavior_json) OR behavior_json IS NULL),\n    \"ingest_started_at\" TIMESTAMP NOT NULL,\n    \"ingest_finished_at\" TIMESTAMP,\n    \"elaboration\" TEXT CHECK(json_valid(elaboration) OR elaboration IS NULL),\n    \"created_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"created_by\" TEXT DEFAULT 'UNKNOWN',\n    \"updated_at\" TIMESTAMP,\n    \"updated_by\" TEXT,\n    \"deleted_at\" TIMESTAMP,\n    \"deleted_by\" TEXT,\n    \"activity_log\" TEXT,\n    FOREIGN KEY(\"device_id\") REFERENCES \"device\"(\"device_id\"),\n    FOREIGN KEY(\"behavior_id\") REFERENCES \"behavior\"(\"behavior_id\"),\n    UNIQUE(\"device_id\", \"created_at\")\n)"},{"name":"ur_ingest_session_fs_path","type":"table","comment":"Immutable ingest session file system path represents a discovery or \"walk\" path. If  the session included a file system scan, then root_path is the  root file system path that was scanned. If the session was discovering  resources in another target then root_path would be  representative of the target path (could be a URI).","columns":[{"name":"ur_ingest_session_fs_path_id","type":"VARCHAR","nullable":false,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isVarChar\":true}"},{"name":"ingest_session_id","type":"VARCHAR","nullable":false,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isVarChar\":true}"},{"name":"root_path","type":"TEXT","nullable":false,"default":null,"comment":""},{"name":"elaboration","type":"TEXT","nullable":true,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isJsonText\":true}"},{"name":"created_at","type":"TIMESTAMP","nullable":true,"default":"CURRENT_TIMESTAMP","comment":""},{"name":"created_by","type":"TEXT","nullable":true,"default":"'UNKNOWN'","comment":""},{"name":"updated_at","type":"TIMESTAMP","nullable":true,"default":null,"comment":""},{"name":"updated_by","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"deleted_at","type":"TIMESTAMP","nullable":true,"default":null,"comment":""},{"name":"deleted_by","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"activity_log","type":"TEXT","nullable":true,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isJsonSqlDomain\":true}"}],"indexes":[{"name":"idx_ur_ingest_session_fs_path__ingest_session_id__root_path","def":"CREATE INDEX \"idx_ur_ingest_session_fs_path__ingest_session_id__root_path\" ON \"ur_ingest_session_fs_path\"(\"ingest_session_id\", \"root_path\")","table":"ur_ingest_session_fs_path","columns":["ingest_session_id","root_path"],"comment":""},{"name":"sqlite_autoindex_ur_ingest_session_fs_path_2","def":"UNIQUE (ingest_session_id, root_path, created_at)","table":"ur_ingest_session_fs_path","columns":["ingest_session_id","root_path","created_at"],"comment":""},{"name":"sqlite_autoindex_ur_ingest_session_fs_path_1","def":"PRIMARY KEY (ur_ingest_session_fs_path_id)","table":"ur_ingest_session_fs_path","columns":["ur_ingest_session_fs_path_id"],"comment":""}],"constraints":[{"name":"ur_ingest_session_fs_path_id","type":"PRIMARY KEY","def":"PRIMARY KEY (ur_ingest_session_fs_path_id)","table":"ur_ingest_session_fs_path","referenced_table":null,"columns":["ur_ingest_session_fs_path_id"],"referenced_columns":null,"comment":""},{"name":"- (Foreign key ID: 0)","type":"FOREIGN KEY","def":"FOREIGN KEY (ingest_session_id) REFERENCES ur_ingest_session (ur_ingest_session_id) ON UPDATE NO ACTION ON DELETE NO ACTION MATCH NONE","table":"ur_ingest_session_fs_path","referenced_table":"ur_ingest_session","columns":["ingest_session_id"],"referenced_columns":["ur_ingest_session_id"],"comment":""},{"name":"sqlite_autoindex_ur_ingest_session_fs_path_2","type":"UNIQUE","def":"UNIQUE (ingest_session_id, root_path, created_at)","table":"ur_ingest_session_fs_path","referenced_table":null,"columns":["ingest_session_id","root_path","created_at"],"referenced_columns":null,"comment":""},{"name":"sqlite_autoindex_ur_ingest_session_fs_path_1","type":"PRIMARY KEY","def":"PRIMARY KEY (ur_ingest_session_fs_path_id)","table":"ur_ingest_session_fs_path","referenced_table":null,"columns":["ur_ingest_session_fs_path_id"],"referenced_columns":null,"comment":""},{"name":"-","type":"CHECK","def":"CHECK(json_valid(elaboration) OR elaboration IS NULL)","table":"ur_ingest_session_fs_path","referenced_table":null,"columns":["elaboration"],"referenced_columns":null,"comment":""}],"triggers":[],"def":"CREATE TABLE \"ur_ingest_session_fs_path\" (\n    \"ur_ingest_session_fs_path_id\" VARCHAR PRIMARY KEY NOT NULL,\n    \"ingest_session_id\" VARCHAR NOT NULL,\n    \"root_path\" TEXT NOT NULL,\n    \"elaboration\" TEXT CHECK(json_valid(elaboration) OR elaboration IS NULL),\n    \"created_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"created_by\" TEXT DEFAULT 'UNKNOWN',\n    \"updated_at\" TIMESTAMP,\n    \"updated_by\" TEXT,\n    \"deleted_at\" TIMESTAMP,\n    \"deleted_by\" TEXT,\n    \"activity_log\" TEXT,\n    FOREIGN KEY(\"ingest_session_id\") REFERENCES \"ur_ingest_session\"(\"ur_ingest_session_id\"),\n    UNIQUE(\"ingest_session_id\", \"root_path\", \"created_at\")\n)"},{"name":"uniform_resource","type":"table","comment":"Immutable resource and content information. On multiple executions,\nuniform_resource are inserted only if the the content (see unique\nindex for details). For historical logging, uniform_resource has foreign\nkey references to both ur_ingest_session and ur_ingest_session_fs_path\ntables to indicate which particular session and ingestion path the\nresourced was inserted during.","columns":[{"name":"uniform_resource_id","type":"VARCHAR","nullable":false,"default":null,"comment":"uniform_resource ULID primary key"},{"name":"device_id","type":"VARCHAR","nullable":false,"default":null,"comment":"which device row introduced this resource"},{"name":"ingest_session_id","type":"VARCHAR","nullable":false,"default":null,"comment":"which ur_ingest_session row introduced this resource"},{"name":"ingest_fs_path_id","type":"VARCHAR","nullable":false,"default":null,"comment":"which ur_ingest_session_fs_path row introduced this resource"},{"name":"uri","type":"TEXT","nullable":false,"default":null,"comment":"the resource's URI (dependent on how it was acquired and on which device)"},{"name":"content_digest","type":"TEXT","nullable":false,"default":null,"comment":"'-' when no hash was computed (not NULL); content_digest for symlinks will be the same as their target"},{"name":"content","type":"BLOB","nullable":true,"default":null,"comment":"either NULL if no content was acquired or the actual blob/text of the content"},{"name":"nature","type":"TEXT","nullable":true,"default":null,"comment":"file extension or MIME"},{"name":"size_bytes","type":"INTEGER","nullable":true,"default":null,"comment":""},{"name":"last_modified_at","type":"TIMESTAMP","nullable":true,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isDateSqlDomain\":true,\"isDateTime\":true}"},{"name":"content_fm_body_attrs","type":"TEXT","nullable":true,"default":null,"comment":"each component of frontmatter-based content ({ frontMatter: '', body: '', attrs: {...} })"},{"name":"frontmatter","type":"TEXT","nullable":true,"default":null,"comment":"meta data or other \"frontmatter\" in JSON format"},{"name":"elaboration","type":"TEXT","nullable":true,"default":null,"comment":"anything that doesn't fit in other columns (JSON)"},{"name":"created_at","type":"TIMESTAMP","nullable":true,"default":"CURRENT_TIMESTAMP","comment":""},{"name":"created_by","type":"TEXT","nullable":true,"default":"'UNKNOWN'","comment":""},{"name":"updated_at","type":"TIMESTAMP","nullable":true,"default":null,"comment":""},{"name":"updated_by","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"deleted_at","type":"TIMESTAMP","nullable":true,"default":null,"comment":""},{"name":"deleted_by","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"activity_log","type":"TEXT","nullable":true,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isJsonSqlDomain\":true}"}],"indexes":[{"name":"idx_uniform_resource__device_id__uri","def":"CREATE INDEX \"idx_uniform_resource__device_id__uri\" ON \"uniform_resource\"(\"device_id\", \"uri\")","table":"uniform_resource","columns":["device_id","uri"],"comment":""},{"name":"sqlite_autoindex_uniform_resource_2","def":"UNIQUE (device_id, content_digest, uri, size_bytes, last_modified_at)","table":"uniform_resource","columns":["device_id","content_digest","uri","size_bytes","last_modified_at"],"comment":""},{"name":"sqlite_autoindex_uniform_resource_1","def":"PRIMARY KEY (uniform_resource_id)","table":"uniform_resource","columns":["uniform_resource_id"],"comment":""}],"constraints":[{"name":"uniform_resource_id","type":"PRIMARY KEY","def":"PRIMARY KEY (uniform_resource_id)","table":"uniform_resource","referenced_table":null,"columns":["uniform_resource_id"],"referenced_columns":null,"comment":""},{"name":"- (Foreign key ID: 0)","type":"FOREIGN KEY","def":"FOREIGN KEY (ingest_fs_path_id) REFERENCES ur_ingest_session_fs_path (ur_ingest_session_fs_path_id) ON UPDATE NO ACTION ON DELETE NO ACTION MATCH NONE","table":"uniform_resource","referenced_table":"ur_ingest_session_fs_path","columns":["ingest_fs_path_id"],"referenced_columns":["ur_ingest_session_fs_path_id"],"comment":""},{"name":"- (Foreign key ID: 1)","type":"FOREIGN KEY","def":"FOREIGN KEY (ingest_session_id) REFERENCES ur_ingest_session (ur_ingest_session_id) ON UPDATE NO ACTION ON DELETE NO ACTION MATCH NONE","table":"uniform_resource","referenced_table":"ur_ingest_session","columns":["ingest_session_id"],"referenced_columns":["ur_ingest_session_id"],"comment":""},{"name":"- (Foreign key ID: 2)","type":"FOREIGN KEY","def":"FOREIGN KEY (device_id) REFERENCES device (device_id) ON UPDATE NO ACTION ON DELETE NO ACTION MATCH NONE","table":"uniform_resource","referenced_table":"device","columns":["device_id"],"referenced_columns":["device_id"],"comment":""},{"name":"sqlite_autoindex_uniform_resource_2","type":"UNIQUE","def":"UNIQUE (device_id, content_digest, uri, size_bytes, last_modified_at)","table":"uniform_resource","referenced_table":null,"columns":["device_id","content_digest","uri","size_bytes","last_modified_at"],"referenced_columns":null,"comment":""},{"name":"sqlite_autoindex_uniform_resource_1","type":"PRIMARY KEY","def":"PRIMARY KEY (uniform_resource_id)","table":"uniform_resource","referenced_table":null,"columns":["uniform_resource_id"],"referenced_columns":null,"comment":""},{"name":"-","type":"CHECK","def":"CHECK(json_valid(content_fm_body_attrs) OR content_fm_body_attrs IS NULL)","table":"uniform_resource","referenced_table":null,"columns":["content","content_fm_body_attrs"],"referenced_columns":null,"comment":""},{"name":"-","type":"CHECK","def":"CHECK(json_valid(frontmatter) OR frontmatter IS NULL)","table":"uniform_resource","referenced_table":null,"columns":["frontmatter"],"referenced_columns":null,"comment":""},{"name":"-","type":"CHECK","def":"CHECK(json_valid(elaboration) OR elaboration IS NULL)","table":"uniform_resource","referenced_table":null,"columns":["elaboration"],"referenced_columns":null,"comment":""}],"triggers":[],"def":"CREATE TABLE \"uniform_resource\" (\n    \"uniform_resource_id\" VARCHAR PRIMARY KEY NOT NULL,\n    \"device_id\" VARCHAR NOT NULL,\n    \"ingest_session_id\" VARCHAR NOT NULL,\n    \"ingest_fs_path_id\" VARCHAR NOT NULL,\n    \"uri\" TEXT NOT NULL,\n    \"content_digest\" TEXT NOT NULL,\n    \"content\" BLOB,\n    \"nature\" TEXT,\n    \"size_bytes\" INTEGER,\n    \"last_modified_at\" TIMESTAMP,\n    \"content_fm_body_attrs\" TEXT CHECK(json_valid(content_fm_body_attrs) OR content_fm_body_attrs IS NULL),\n    \"frontmatter\" TEXT CHECK(json_valid(frontmatter) OR frontmatter IS NULL),\n    \"elaboration\" TEXT CHECK(json_valid(elaboration) OR elaboration IS NULL),\n    \"created_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"created_by\" TEXT DEFAULT 'UNKNOWN',\n    \"updated_at\" TIMESTAMP,\n    \"updated_by\" TEXT,\n    \"deleted_at\" TIMESTAMP,\n    \"deleted_by\" TEXT,\n    \"activity_log\" TEXT,\n    FOREIGN KEY(\"device_id\") REFERENCES \"device\"(\"device_id\"),\n    FOREIGN KEY(\"ingest_session_id\") REFERENCES \"ur_ingest_session\"(\"ur_ingest_session_id\"),\n    FOREIGN KEY(\"ingest_fs_path_id\") REFERENCES \"ur_ingest_session_fs_path\"(\"ur_ingest_session_fs_path_id\"),\n    UNIQUE(\"device_id\", \"content_digest\", \"uri\", \"size_bytes\", \"last_modified_at\")\n)"},{"name":"uniform_resource_transform","type":"table","comment":"uniform_resource transformed content","columns":[{"name":"uniform_resource_transform_id","type":"VARCHAR","nullable":false,"default":null,"comment":"uniform_resource_transform ULID primary key"},{"name":"uniform_resource_id","type":"VARCHAR","nullable":false,"default":null,"comment":"uniform_resource row ID of original content"},{"name":"uri","type":"TEXT","nullable":false,"default":null,"comment":""},{"name":"content_digest","type":"TEXT","nullable":false,"default":null,"comment":"transformed content hash"},{"name":"content","type":"BLOB","nullable":true,"default":null,"comment":"transformed content"},{"name":"nature","type":"TEXT","nullable":true,"default":null,"comment":"file extension or MIME"},{"name":"size_bytes","type":"INTEGER","nullable":true,"default":null,"comment":""},{"name":"elaboration","type":"TEXT","nullable":true,"default":null,"comment":"anything that doesn't fit in other columns (JSON)"},{"name":"created_at","type":"TIMESTAMP","nullable":true,"default":"CURRENT_TIMESTAMP","comment":""},{"name":"created_by","type":"TEXT","nullable":true,"default":"'UNKNOWN'","comment":""},{"name":"updated_at","type":"TIMESTAMP","nullable":true,"default":null,"comment":""},{"name":"updated_by","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"deleted_at","type":"TIMESTAMP","nullable":true,"default":null,"comment":""},{"name":"deleted_by","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"activity_log","type":"TEXT","nullable":true,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isJsonSqlDomain\":true}"}],"indexes":[{"name":"idx_uniform_resource_transform__uniform_resource_id__content_digest","def":"CREATE INDEX \"idx_uniform_resource_transform__uniform_resource_id__content_digest\" ON \"uniform_resource_transform\"(\"uniform_resource_id\", \"content_digest\")","table":"uniform_resource_transform","columns":["uniform_resource_id","content_digest"],"comment":""},{"name":"sqlite_autoindex_uniform_resource_transform_2","def":"UNIQUE (uniform_resource_id, content_digest, nature, size_bytes)","table":"uniform_resource_transform","columns":["uniform_resource_id","content_digest","nature","size_bytes"],"comment":""},{"name":"sqlite_autoindex_uniform_resource_transform_1","def":"PRIMARY KEY (uniform_resource_transform_id)","table":"uniform_resource_transform","columns":["uniform_resource_transform_id"],"comment":""}],"constraints":[{"name":"uniform_resource_transform_id","type":"PRIMARY KEY","def":"PRIMARY KEY (uniform_resource_transform_id)","table":"uniform_resource_transform","referenced_table":null,"columns":["uniform_resource_transform_id"],"referenced_columns":null,"comment":""},{"name":"- (Foreign key ID: 0)","type":"FOREIGN KEY","def":"FOREIGN KEY (uniform_resource_id) REFERENCES uniform_resource (uniform_resource_id) ON UPDATE NO ACTION ON DELETE NO ACTION MATCH NONE","table":"uniform_resource_transform","referenced_table":"uniform_resource","columns":["uniform_resource_id"],"referenced_columns":["uniform_resource_id"],"comment":""},{"name":"sqlite_autoindex_uniform_resource_transform_2","type":"UNIQUE","def":"UNIQUE (uniform_resource_id, content_digest, nature, size_bytes)","table":"uniform_resource_transform","referenced_table":null,"columns":["uniform_resource_id","content_digest","nature","size_bytes"],"referenced_columns":null,"comment":""},{"name":"sqlite_autoindex_uniform_resource_transform_1","type":"PRIMARY KEY","def":"PRIMARY KEY (uniform_resource_transform_id)","table":"uniform_resource_transform","referenced_table":null,"columns":["uniform_resource_transform_id"],"referenced_columns":null,"comment":""},{"name":"-","type":"CHECK","def":"CHECK(json_valid(elaboration) OR elaboration IS NULL)","table":"uniform_resource_transform","referenced_table":null,"columns":["elaboration"],"referenced_columns":null,"comment":""}],"triggers":[],"def":"CREATE TABLE \"uniform_resource_transform\" (\n    \"uniform_resource_transform_id\" VARCHAR PRIMARY KEY NOT NULL,\n    \"uniform_resource_id\" VARCHAR NOT NULL,\n    \"uri\" TEXT NOT NULL,\n    \"content_digest\" TEXT NOT NULL,\n    \"content\" BLOB,\n    \"nature\" TEXT,\n    \"size_bytes\" INTEGER,\n    \"elaboration\" TEXT CHECK(json_valid(elaboration) OR elaboration IS NULL),\n    \"created_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"created_by\" TEXT DEFAULT 'UNKNOWN',\n    \"updated_at\" TIMESTAMP,\n    \"updated_by\" TEXT,\n    \"deleted_at\" TIMESTAMP,\n    \"deleted_by\" TEXT,\n    \"activity_log\" TEXT,\n    FOREIGN KEY(\"uniform_resource_id\") REFERENCES \"uniform_resource\"(\"uniform_resource_id\"),\n    UNIQUE(\"uniform_resource_id\", \"content_digest\", \"nature\", \"size_bytes\")\n)"},{"name":"ur_ingest_session_fs_path_entry","type":"table","comment":"Contains entries related to file system content ingestion paths. On multiple executions,  unlike uniform_resource, ur_ingest_session_fs_path_entry rows are always inserted and  references the uniform_resource primary key of its related content.  This method allows for a more efficient query of file version differences across  sessions. With SQL queries, you can detect which sessions have a file added or modified,  which sessions have a file deleted, and what the differences are in file contents  if they were modified across sessions.","columns":[{"name":"ur_ingest_session_fs_path_entry_id","type":"VARCHAR","nullable":false,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isVarChar\":true}"},{"name":"ingest_session_id","type":"VARCHAR","nullable":false,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isVarChar\":true}"},{"name":"ingest_fs_path_id","type":"VARCHAR","nullable":false,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isVarChar\":true}"},{"name":"uniform_resource_id","type":"VARCHAR","nullable":true,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isVarChar\":true}"},{"name":"file_path_abs","type":"TEXT","nullable":false,"default":null,"comment":""},{"name":"file_path_rel_parent","type":"TEXT","nullable":false,"default":null,"comment":""},{"name":"file_path_rel","type":"TEXT","nullable":false,"default":null,"comment":""},{"name":"file_basename","type":"TEXT","nullable":false,"default":null,"comment":""},{"name":"file_extn","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"captured_executable","type":"TEXT","nullable":true,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isJsonText\":true}"},{"name":"ur_status","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"ur_diagnostics","type":"TEXT","nullable":true,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isJsonText\":true}"},{"name":"ur_transformations","type":"TEXT","nullable":true,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isJsonText\":true}"},{"name":"elaboration","type":"TEXT","nullable":true,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isJsonText\":true}"},{"name":"created_at","type":"TIMESTAMP","nullable":true,"default":"CURRENT_TIMESTAMP","comment":""},{"name":"created_by","type":"TEXT","nullable":true,"default":"'UNKNOWN'","comment":""},{"name":"updated_at","type":"TIMESTAMP","nullable":true,"default":null,"comment":""},{"name":"updated_by","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"deleted_at","type":"TIMESTAMP","nullable":true,"default":null,"comment":""},{"name":"deleted_by","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"activity_log","type":"TEXT","nullable":true,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isJsonSqlDomain\":true}"}],"indexes":[{"name":"idx_ur_ingest_session_fs_path_entry__ingest_session_id__file_path_abs","def":"CREATE INDEX \"idx_ur_ingest_session_fs_path_entry__ingest_session_id__file_path_abs\" ON \"ur_ingest_session_fs_path_entry\"(\"ingest_session_id\", \"file_path_abs\")","table":"ur_ingest_session_fs_path_entry","columns":["ingest_session_id","file_path_abs"],"comment":""},{"name":"sqlite_autoindex_ur_ingest_session_fs_path_entry_1","def":"PRIMARY KEY (ur_ingest_session_fs_path_entry_id)","table":"ur_ingest_session_fs_path_entry","columns":["ur_ingest_session_fs_path_entry_id"],"comment":""}],"constraints":[{"name":"ur_ingest_session_fs_path_entry_id","type":"PRIMARY KEY","def":"PRIMARY KEY (ur_ingest_session_fs_path_entry_id)","table":"ur_ingest_session_fs_path_entry","referenced_table":null,"columns":["ur_ingest_session_fs_path_entry_id"],"referenced_columns":null,"comment":""},{"name":"- (Foreign key ID: 0)","type":"FOREIGN KEY","def":"FOREIGN KEY (uniform_resource_id) REFERENCES uniform_resource (uniform_resource_id) ON UPDATE NO ACTION ON DELETE NO ACTION MATCH NONE","table":"ur_ingest_session_fs_path_entry","referenced_table":"uniform_resource","columns":["uniform_resource_id"],"referenced_columns":["uniform_resource_id"],"comment":""},{"name":"- (Foreign key ID: 1)","type":"FOREIGN KEY","def":"FOREIGN KEY (ingest_fs_path_id) REFERENCES ur_ingest_session_fs_path (ur_ingest_session_fs_path_id) ON UPDATE NO ACTION ON DELETE NO ACTION MATCH NONE","table":"ur_ingest_session_fs_path_entry","referenced_table":"ur_ingest_session_fs_path","columns":["ingest_fs_path_id"],"referenced_columns":["ur_ingest_session_fs_path_id"],"comment":""},{"name":"- (Foreign key ID: 2)","type":"FOREIGN KEY","def":"FOREIGN KEY (ingest_session_id) REFERENCES ur_ingest_session (ur_ingest_session_id) ON UPDATE NO ACTION ON DELETE NO ACTION MATCH NONE","table":"ur_ingest_session_fs_path_entry","referenced_table":"ur_ingest_session","columns":["ingest_session_id"],"referenced_columns":["ur_ingest_session_id"],"comment":""},{"name":"sqlite_autoindex_ur_ingest_session_fs_path_entry_1","type":"PRIMARY KEY","def":"PRIMARY KEY (ur_ingest_session_fs_path_entry_id)","table":"ur_ingest_session_fs_path_entry","referenced_table":null,"columns":["ur_ingest_session_fs_path_entry_id"],"referenced_columns":null,"comment":""},{"name":"-","type":"CHECK","def":"CHECK(json_valid(captured_executable) OR captured_executable IS NULL)","table":"ur_ingest_session_fs_path_entry","referenced_table":null,"columns":["captured_executable"],"referenced_columns":null,"comment":""},{"name":"-","type":"CHECK","def":"CHECK(json_valid(ur_diagnostics) OR ur_diagnostics IS NULL)","table":"ur_ingest_session_fs_path_entry","referenced_table":null,"columns":["ur_diagnostics"],"referenced_columns":null,"comment":""},{"name":"-","type":"CHECK","def":"CHECK(json_valid(ur_transformations) OR ur_transformations IS NULL)","table":"ur_ingest_session_fs_path_entry","referenced_table":null,"columns":["ur_transformations"],"referenced_columns":null,"comment":""},{"name":"-","type":"CHECK","def":"CHECK(json_valid(elaboration) OR elaboration IS NULL)","table":"ur_ingest_session_fs_path_entry","referenced_table":null,"columns":["elaboration"],"referenced_columns":null,"comment":""}],"triggers":[],"def":"CREATE TABLE \"ur_ingest_session_fs_path_entry\" (\n    \"ur_ingest_session_fs_path_entry_id\" VARCHAR PRIMARY KEY NOT NULL,\n    \"ingest_session_id\" VARCHAR NOT NULL,\n    \"ingest_fs_path_id\" VARCHAR NOT NULL,\n    \"uniform_resource_id\" VARCHAR,\n    \"file_path_abs\" TEXT NOT NULL,\n    \"file_path_rel_parent\" TEXT NOT NULL,\n    \"file_path_rel\" TEXT NOT NULL,\n    \"file_basename\" TEXT NOT NULL,\n    \"file_extn\" TEXT,\n    \"captured_executable\" TEXT CHECK(json_valid(captured_executable) OR captured_executable IS NULL),\n    \"ur_status\" TEXT,\n    \"ur_diagnostics\" TEXT CHECK(json_valid(ur_diagnostics) OR ur_diagnostics IS NULL),\n    \"ur_transformations\" TEXT CHECK(json_valid(ur_transformations) OR ur_transformations IS NULL),\n    \"elaboration\" TEXT CHECK(json_valid(elaboration) OR elaboration IS NULL),\n    \"created_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"created_by\" TEXT DEFAULT 'UNKNOWN',\n    \"updated_at\" TIMESTAMP,\n    \"updated_by\" TEXT,\n    \"deleted_at\" TIMESTAMP,\n    \"deleted_by\" TEXT,\n    \"activity_log\" TEXT,\n    FOREIGN KEY(\"ingest_session_id\") REFERENCES \"ur_ingest_session\"(\"ur_ingest_session_id\"),\n    FOREIGN KEY(\"ingest_fs_path_id\") REFERENCES \"ur_ingest_session_fs_path\"(\"ur_ingest_session_fs_path_id\"),\n    FOREIGN KEY(\"uniform_resource_id\") REFERENCES \"uniform_resource\"(\"uniform_resource_id\")\n)"}],"relations":[{"table":"behavior","columns":["device_id"],"cardinality":"Zero or more","parent_table":"device","parent_columns":["device_id"],"parent_cardinality":"Exactly one","def":"FOREIGN KEY (device_id) REFERENCES device (device_id) ON UPDATE NO ACTION ON DELETE NO ACTION MATCH NONE","virtual":false},{"table":"ur_ingest_session","columns":["behavior_id"],"cardinality":"Zero or more","parent_table":"behavior","parent_columns":["behavior_id"],"parent_cardinality":"Zero or one","def":"FOREIGN KEY (behavior_id) REFERENCES behavior (behavior_id) ON UPDATE NO ACTION ON DELETE NO ACTION MATCH NONE","virtual":false},{"table":"ur_ingest_session","columns":["device_id"],"cardinality":"Zero or more","parent_table":"device","parent_columns":["device_id"],"parent_cardinality":"Exactly one","def":"FOREIGN KEY (device_id) REFERENCES device (device_id) ON UPDATE NO ACTION ON DELETE NO ACTION MATCH NONE","virtual":false},{"table":"ur_ingest_session_fs_path","columns":["ingest_session_id"],"cardinality":"Zero or more","parent_table":"ur_ingest_session","parent_columns":["ur_ingest_session_id"],"parent_cardinality":"Exactly one","def":"FOREIGN KEY (ingest_session_id) REFERENCES ur_ingest_session (ur_ingest_session_id) ON UPDATE NO ACTION ON DELETE NO ACTION MATCH NONE","virtual":false},{"table":"uniform_resource","columns":["ingest_fs_path_id"],"cardinality":"Zero or more","parent_table":"ur_ingest_session_fs_path","parent_columns":["ur_ingest_session_fs_path_id"],"parent_cardinality":"Exactly one","def":"FOREIGN KEY (ingest_fs_path_id) REFERENCES ur_ingest_session_fs_path (ur_ingest_session_fs_path_id) ON UPDATE NO ACTION ON DELETE NO ACTION MATCH NONE","virtual":false},{"table":"uniform_resource","columns":["ingest_session_id"],"cardinality":"Zero or more","parent_table":"ur_ingest_session","parent_columns":["ur_ingest_session_id"],"parent_cardinality":"Exactly one","def":"FOREIGN KEY (ingest_session_id) REFERENCES ur_ingest_session (ur_ingest_session_id) ON UPDATE NO ACTION ON DELETE NO ACTION MATCH NONE","virtual":false},{"table":"uniform_resource","columns":["device_id"],"cardinality":"Zero or more","parent_table":"device","parent_columns":["device_id"],"parent_cardinality":"Exactly one","def":"FOREIGN KEY (device_id) REFERENCES device (device_id) ON UPDATE NO ACTION ON DELETE NO ACTION MATCH NONE","virtual":false},{"table":"uniform_resource_transform","columns":["uniform_resource_id"],"cardinality":"Zero or more","parent_table":"uniform_resource","parent_columns":["uniform_resource_id"],"parent_cardinality":"Exactly one","def":"FOREIGN KEY (uniform_resource_id) REFERENCES uniform_resource (uniform_resource_id) ON UPDATE NO ACTION ON DELETE NO ACTION MATCH NONE","virtual":false},{"table":"ur_ingest_session_fs_path_entry","columns":["uniform_resource_id"],"cardinality":"Zero or more","parent_table":"uniform_resource","parent_columns":["uniform_resource_id"],"parent_cardinality":"Zero or one","def":"FOREIGN KEY (uniform_resource_id) REFERENCES uniform_resource (uniform_resource_id) ON UPDATE NO ACTION ON DELETE NO ACTION MATCH NONE","virtual":false},{"table":"ur_ingest_session_fs_path_entry","columns":["ingest_fs_path_id"],"cardinality":"Zero or more","parent_table":"ur_ingest_session_fs_path","parent_columns":["ur_ingest_session_fs_path_id"],"parent_cardinality":"Exactly one","def":"FOREIGN KEY (ingest_fs_path_id) REFERENCES ur_ingest_session_fs_path (ur_ingest_session_fs_path_id) ON UPDATE NO ACTION ON DELETE NO ACTION MATCH NONE","virtual":false},{"table":"ur_ingest_session_fs_path_entry","columns":["ingest_session_id"],"cardinality":"Zero or more","parent_table":"ur_ingest_session","parent_columns":["ur_ingest_session_id"],"parent_cardinality":"Exactly one","def":"FOREIGN KEY (ingest_session_id) REFERENCES ur_ingest_session (ur_ingest_session_id) ON UPDATE NO ACTION ON DELETE NO ACTION MATCH NONE","virtual":false}],"functions":null,"driver":{"name":"sqlite","database_version":"3.42.0","meta":{}}}
