{"name":"Resource Surveillance State Schema","desc":"","tables":[{"name":"sqlpage_files","type":"table","comment":"","columns":[{"name":"path","type":"TEXT","nullable":false,"default":null,"comment":""},{"name":"contents","type":"TEXT","nullable":false,"default":null,"comment":""},{"name":"last_modified","type":"TIMESTAMP","nullable":true,"default":"CURRENT_TIMESTAMP","comment":""}],"indexes":[{"name":"sqlite_autoindex_sqlpage_files_1","def":"PRIMARY KEY (path)","table":"sqlpage_files","columns":["path"],"comment":""}],"constraints":[{"name":"path","type":"PRIMARY KEY","def":"PRIMARY KEY (path)","table":"sqlpage_files","referenced_table":null,"columns":["path"],"referenced_columns":null,"comment":""},{"name":"sqlite_autoindex_sqlpage_files_1","type":"PRIMARY KEY","def":"PRIMARY KEY (path)","table":"sqlpage_files","referenced_table":null,"columns":["path"],"referenced_columns":null,"comment":""}],"triggers":[],"def":"CREATE TABLE \"sqlpage_files\" (\n    \"path\" TEXT PRIMARY KEY NOT NULL,\n    \"contents\" TEXT NOT NULL,\n    \"last_modified\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n)"},{"name":"device","type":"table","comment":"Identity, network segmentation, and sysinfo for devices on which uniform_resource are found","columns":[{"name":"device_id","type":"ULID","nullable":false,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isUlid\":true}"},{"name":"name","type":"TEXT","nullable":false,"default":null,"comment":"unique device identifier (defaults to hostname)"},{"name":"state","type":"TEXT","nullable":false,"default":null,"comment":"should be \"SINGLETON\" if only one state is allowed, or other tags if multiple states are allowed"},{"name":"boundary","type":"TEXT","nullable":false,"default":null,"comment":"can be IP address, VLAN, or any other device name differentiator"},{"name":"segmentation","type":"TEXT","nullable":true,"default":null,"comment":"zero trust or other network segmentation"},{"name":"state_sysinfo","type":"TEXT","nullable":true,"default":null,"comment":"any sysinfo or other state data that is specific to this device (mutable)"},{"name":"elaboration","type":"TEXT","nullable":true,"default":null,"comment":"any elaboration needed for the device (mutable)"},{"name":"created_at","type":"TIMESTAMP","nullable":true,"default":"CURRENT_TIMESTAMP","comment":""},{"name":"created_by","type":"TEXT","nullable":true,"default":"'UNKNOWN'","comment":""},{"name":"updated_at","type":"TIMESTAMP","nullable":true,"default":null,"comment":""},{"name":"updated_by","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"deleted_at","type":"TIMESTAMP","nullable":true,"default":null,"comment":""},{"name":"deleted_by","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"activity_log","type":"TEXT","nullable":true,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isJsonSqlDomain\":true}"}],"indexes":[{"name":"idx_device__name__state","def":"CREATE INDEX \"idx_device__name__state\" ON \"device\"(\"name\", \"state\")","table":"device","columns":["name","state"],"comment":""},{"name":"sqlite_autoindex_device_2","def":"UNIQUE (name, state, boundary)","table":"device","columns":["name","state","boundary"],"comment":""},{"name":"sqlite_autoindex_device_1","def":"PRIMARY KEY (device_id)","table":"device","columns":["device_id"],"comment":""}],"constraints":[{"name":"device_id","type":"PRIMARY KEY","def":"PRIMARY KEY (device_id)","table":"device","referenced_table":null,"columns":["device_id"],"referenced_columns":null,"comment":""},{"name":"sqlite_autoindex_device_2","type":"UNIQUE","def":"UNIQUE (name, state, boundary)","table":"device","referenced_table":null,"columns":["name","state","boundary"],"referenced_columns":null,"comment":""},{"name":"sqlite_autoindex_device_1","type":"PRIMARY KEY","def":"PRIMARY KEY (device_id)","table":"device","referenced_table":null,"columns":["device_id"],"referenced_columns":null,"comment":""},{"name":"-","type":"CHECK","def":"CHECK(json_valid(state))","table":"device","referenced_table":null,"columns":["state"],"referenced_columns":null,"comment":""},{"name":"-","type":"CHECK","def":"CHECK(json_valid(segmentation) OR segmentation IS NULL)","table":"device","referenced_table":null,"columns":["segmentation"],"referenced_columns":null,"comment":""},{"name":"-","type":"CHECK","def":"CHECK(json_valid(state_sysinfo) OR state_sysinfo IS NULL)","table":"device","referenced_table":null,"columns":["state","state_sysinfo"],"referenced_columns":null,"comment":""},{"name":"-","type":"CHECK","def":"CHECK(json_valid(elaboration) OR elaboration IS NULL)","table":"device","referenced_table":null,"columns":["elaboration"],"referenced_columns":null,"comment":""}],"triggers":[],"def":"CREATE TABLE \"device\" (\n    \"device_id\" ULID PRIMARY KEY NOT NULL,\n    \"name\" TEXT NOT NULL,\n    \"state\" TEXT CHECK(json_valid(state)) NOT NULL,\n    \"boundary\" TEXT NOT NULL,\n    \"segmentation\" TEXT CHECK(json_valid(segmentation) OR segmentation IS NULL),\n    \"state_sysinfo\" TEXT CHECK(json_valid(state_sysinfo) OR state_sysinfo IS NULL),\n    \"elaboration\" TEXT CHECK(json_valid(elaboration) OR elaboration IS NULL),\n    \"created_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"created_by\" TEXT DEFAULT 'UNKNOWN',\n    \"updated_at\" TIMESTAMP,\n    \"updated_by\" TEXT,\n    \"deleted_at\" TIMESTAMP,\n    \"deleted_by\" TEXT,\n    \"activity_log\" TEXT,\n    UNIQUE(\"name\", \"state\", \"boundary\")\n)"},{"name":"ur_walk_session","type":"table","comment":"Immutable FileSystem Walk Sessions Represents a single file system scan (or  \"walk\") session. Each time a directory is scanned for files and entries, a  record is created here. ur_walk_session has a foreign key reference to the  device table so that the same device can be used for multiple walk sessions  but also the walk sessions can be merged across workstations / servers for easier  detection of changes and similaries between file systems on different devices.","columns":[{"name":"ur_walk_session_id","type":"ULID","nullable":false,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isUlid\":true}"},{"name":"device_id","type":"ULID","nullable":false,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isUlid\":true}"},{"name":"walk_started_at","type":"TIMESTAMP","nullable":false,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isDateSqlDomain\":true,\"isDateTime\":true}"},{"name":"walk_finished_at","type":"TIMESTAMP","nullable":true,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isDateSqlDomain\":true,\"isDateTime\":true}"},{"name":"ignore_paths_regex","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"blobs_regex","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"digests_regex","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"elaboration","type":"TEXT","nullable":true,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isJsonText\":true}"},{"name":"created_at","type":"TIMESTAMP","nullable":true,"default":"CURRENT_TIMESTAMP","comment":""},{"name":"created_by","type":"TEXT","nullable":true,"default":"'UNKNOWN'","comment":""},{"name":"updated_at","type":"TIMESTAMP","nullable":true,"default":null,"comment":""},{"name":"updated_by","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"deleted_at","type":"TIMESTAMP","nullable":true,"default":null,"comment":""},{"name":"deleted_by","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"activity_log","type":"TEXT","nullable":true,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isJsonSqlDomain\":true}"}],"indexes":[{"name":"sqlite_autoindex_ur_walk_session_2","def":"UNIQUE (device_id, created_at)","table":"ur_walk_session","columns":["device_id","created_at"],"comment":""},{"name":"sqlite_autoindex_ur_walk_session_1","def":"PRIMARY KEY (ur_walk_session_id)","table":"ur_walk_session","columns":["ur_walk_session_id"],"comment":""}],"constraints":[{"name":"ur_walk_session_id","type":"PRIMARY KEY","def":"PRIMARY KEY (ur_walk_session_id)","table":"ur_walk_session","referenced_table":null,"columns":["ur_walk_session_id"],"referenced_columns":null,"comment":""},{"name":"- (Foreign key ID: 0)","type":"FOREIGN KEY","def":"FOREIGN KEY (device_id) REFERENCES device (device_id) ON UPDATE NO ACTION ON DELETE NO ACTION MATCH NONE","table":"ur_walk_session","referenced_table":"device","columns":["device_id"],"referenced_columns":["device_id"],"comment":""},{"name":"sqlite_autoindex_ur_walk_session_2","type":"UNIQUE","def":"UNIQUE (device_id, created_at)","table":"ur_walk_session","referenced_table":null,"columns":["device_id","created_at"],"referenced_columns":null,"comment":""},{"name":"sqlite_autoindex_ur_walk_session_1","type":"PRIMARY KEY","def":"PRIMARY KEY (ur_walk_session_id)","table":"ur_walk_session","referenced_table":null,"columns":["ur_walk_session_id"],"referenced_columns":null,"comment":""},{"name":"-","type":"CHECK","def":"CHECK(json_valid(elaboration) OR elaboration IS NULL)","table":"ur_walk_session","referenced_table":null,"columns":["elaboration"],"referenced_columns":null,"comment":""}],"triggers":[],"def":"CREATE TABLE \"ur_walk_session\" (\n    \"ur_walk_session_id\" ULID PRIMARY KEY NOT NULL,\n    \"device_id\" ULID NOT NULL,\n    \"walk_started_at\" TIMESTAMP NOT NULL,\n    \"walk_finished_at\" TIMESTAMP,\n    \"ignore_paths_regex\" TEXT,\n    \"blobs_regex\" TEXT,\n    \"digests_regex\" TEXT,\n    \"elaboration\" TEXT CHECK(json_valid(elaboration) OR elaboration IS NULL),\n    \"created_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"created_by\" TEXT DEFAULT 'UNKNOWN',\n    \"updated_at\" TIMESTAMP,\n    \"updated_by\" TEXT,\n    \"deleted_at\" TIMESTAMP,\n    \"deleted_by\" TEXT,\n    \"activity_log\" TEXT,\n    FOREIGN KEY(\"device_id\") REFERENCES \"device\"(\"device_id\"),\n    UNIQUE(\"device_id\", \"created_at\")\n)"},{"name":"ur_walk_session_path","type":"table","comment":"Stores file system content walk paths associated with a particular\nsession and may have one or more root paths per session.","columns":[{"name":"ur_walk_session_path_id","type":"ULID","nullable":false,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isUlid\":true}"},{"name":"walk_session_id","type":"ULID","nullable":false,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isUlid\":true}"},{"name":"root_path","type":"TEXT","nullable":false,"default":null,"comment":""},{"name":"elaboration","type":"TEXT","nullable":true,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isJsonText\":true}"},{"name":"created_at","type":"TIMESTAMP","nullable":true,"default":"CURRENT_TIMESTAMP","comment":""},{"name":"created_by","type":"TEXT","nullable":true,"default":"'UNKNOWN'","comment":""},{"name":"updated_at","type":"TIMESTAMP","nullable":true,"default":null,"comment":""},{"name":"updated_by","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"deleted_at","type":"TIMESTAMP","nullable":true,"default":null,"comment":""},{"name":"deleted_by","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"activity_log","type":"TEXT","nullable":true,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isJsonSqlDomain\":true}"}],"indexes":[{"name":"idx_ur_walk_session_path__walk_session_id__root_path","def":"CREATE INDEX \"idx_ur_walk_session_path__walk_session_id__root_path\" ON \"ur_walk_session_path\"(\"walk_session_id\", \"root_path\")","table":"ur_walk_session_path","columns":["walk_session_id","root_path"],"comment":""},{"name":"sqlite_autoindex_ur_walk_session_path_2","def":"UNIQUE (walk_session_id, root_path, created_at)","table":"ur_walk_session_path","columns":["walk_session_id","root_path","created_at"],"comment":""},{"name":"sqlite_autoindex_ur_walk_session_path_1","def":"PRIMARY KEY (ur_walk_session_path_id)","table":"ur_walk_session_path","columns":["ur_walk_session_path_id"],"comment":""}],"constraints":[{"name":"ur_walk_session_path_id","type":"PRIMARY KEY","def":"PRIMARY KEY (ur_walk_session_path_id)","table":"ur_walk_session_path","referenced_table":null,"columns":["ur_walk_session_path_id"],"referenced_columns":null,"comment":""},{"name":"- (Foreign key ID: 0)","type":"FOREIGN KEY","def":"FOREIGN KEY (walk_session_id) REFERENCES ur_walk_session (ur_walk_session_id) ON UPDATE NO ACTION ON DELETE NO ACTION MATCH NONE","table":"ur_walk_session_path","referenced_table":"ur_walk_session","columns":["walk_session_id"],"referenced_columns":["ur_walk_session_id"],"comment":""},{"name":"sqlite_autoindex_ur_walk_session_path_2","type":"UNIQUE","def":"UNIQUE (walk_session_id, root_path, created_at)","table":"ur_walk_session_path","referenced_table":null,"columns":["walk_session_id","root_path","created_at"],"referenced_columns":null,"comment":""},{"name":"sqlite_autoindex_ur_walk_session_path_1","type":"PRIMARY KEY","def":"PRIMARY KEY (ur_walk_session_path_id)","table":"ur_walk_session_path","referenced_table":null,"columns":["ur_walk_session_path_id"],"referenced_columns":null,"comment":""},{"name":"-","type":"CHECK","def":"CHECK(json_valid(elaboration) OR elaboration IS NULL)","table":"ur_walk_session_path","referenced_table":null,"columns":["elaboration"],"referenced_columns":null,"comment":""}],"triggers":[],"def":"CREATE TABLE \"ur_walk_session_path\" (\n    \"ur_walk_session_path_id\" ULID PRIMARY KEY NOT NULL,\n    \"walk_session_id\" ULID NOT NULL,\n    \"root_path\" TEXT NOT NULL,\n    \"elaboration\" TEXT CHECK(json_valid(elaboration) OR elaboration IS NULL),\n    \"created_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"created_by\" TEXT DEFAULT 'UNKNOWN',\n    \"updated_at\" TIMESTAMP,\n    \"updated_by\" TEXT,\n    \"deleted_at\" TIMESTAMP,\n    \"deleted_by\" TEXT,\n    \"activity_log\" TEXT,\n    FOREIGN KEY(\"walk_session_id\") REFERENCES \"ur_walk_session\"(\"ur_walk_session_id\"),\n    UNIQUE(\"walk_session_id\", \"root_path\", \"created_at\")\n)"},{"name":"uniform_resource","type":"table","comment":"Records file system content information. On multiple executions,\nuniform_resource are inserted only if the the file content (see unique \nindex for details). For historical logging, uniform_resource has foreign\nkey references to both ur_walk_session and ur_walk_session_path\ntables to indicate which particular session and walk path the\nresourced was inserted during.","columns":[{"name":"uniform_resource_id","type":"ULID","nullable":false,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isUlid\":true}"},{"name":"device_id","type":"ULID","nullable":false,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isUlid\":true}"},{"name":"walk_session_id","type":"ULID","nullable":false,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isUlid\":true}"},{"name":"walk_path_id","type":"ULID","nullable":false,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isUlid\":true}"},{"name":"uri","type":"TEXT","nullable":false,"default":null,"comment":""},{"name":"content_digest","type":"TEXT","nullable":false,"default":null,"comment":""},{"name":"content","type":"BLOB","nullable":true,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isBlobText\":true}"},{"name":"nature","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"size_bytes","type":"INTEGER","nullable":true,"default":null,"comment":""},{"name":"last_modified_at","type":"INTEGER","nullable":true,"default":null,"comment":""},{"name":"content_fm_body_attrs","type":"TEXT","nullable":true,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isJsonText\":true}"},{"name":"frontmatter","type":"TEXT","nullable":true,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isJsonText\":true}"},{"name":"elaboration","type":"TEXT","nullable":true,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isJsonText\":true}"},{"name":"created_at","type":"TIMESTAMP","nullable":true,"default":"CURRENT_TIMESTAMP","comment":""},{"name":"created_by","type":"TEXT","nullable":true,"default":"'UNKNOWN'","comment":""},{"name":"updated_at","type":"TIMESTAMP","nullable":true,"default":null,"comment":""},{"name":"updated_by","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"deleted_at","type":"TIMESTAMP","nullable":true,"default":null,"comment":""},{"name":"deleted_by","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"activity_log","type":"TEXT","nullable":true,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isJsonSqlDomain\":true}"}],"indexes":[{"name":"idx_uniform_resource__device_id__uri","def":"CREATE INDEX \"idx_uniform_resource__device_id__uri\" ON \"uniform_resource\"(\"device_id\", \"uri\")","table":"uniform_resource","columns":["device_id","uri"],"comment":""},{"name":"sqlite_autoindex_uniform_resource_2","def":"UNIQUE (device_id, content_digest, uri, size_bytes, last_modified_at)","table":"uniform_resource","columns":["device_id","content_digest","uri","size_bytes","last_modified_at"],"comment":""},{"name":"sqlite_autoindex_uniform_resource_1","def":"PRIMARY KEY (uniform_resource_id)","table":"uniform_resource","columns":["uniform_resource_id"],"comment":""}],"constraints":[{"name":"uniform_resource_id","type":"PRIMARY KEY","def":"PRIMARY KEY (uniform_resource_id)","table":"uniform_resource","referenced_table":null,"columns":["uniform_resource_id"],"referenced_columns":null,"comment":""},{"name":"- (Foreign key ID: 0)","type":"FOREIGN KEY","def":"FOREIGN KEY (walk_path_id) REFERENCES ur_walk_session_path (ur_walk_session_path_id) ON UPDATE NO ACTION ON DELETE NO ACTION MATCH NONE","table":"uniform_resource","referenced_table":"ur_walk_session_path","columns":["walk_path_id"],"referenced_columns":["ur_walk_session_path_id"],"comment":""},{"name":"- (Foreign key ID: 1)","type":"FOREIGN KEY","def":"FOREIGN KEY (walk_session_id) REFERENCES ur_walk_session (ur_walk_session_id) ON UPDATE NO ACTION ON DELETE NO ACTION MATCH NONE","table":"uniform_resource","referenced_table":"ur_walk_session","columns":["walk_session_id"],"referenced_columns":["ur_walk_session_id"],"comment":""},{"name":"- (Foreign key ID: 2)","type":"FOREIGN KEY","def":"FOREIGN KEY (device_id) REFERENCES device (device_id) ON UPDATE NO ACTION ON DELETE NO ACTION MATCH NONE","table":"uniform_resource","referenced_table":"device","columns":["device_id"],"referenced_columns":["device_id"],"comment":""},{"name":"sqlite_autoindex_uniform_resource_2","type":"UNIQUE","def":"UNIQUE (device_id, content_digest, uri, size_bytes, last_modified_at)","table":"uniform_resource","referenced_table":null,"columns":["device_id","content_digest","uri","size_bytes","last_modified_at"],"referenced_columns":null,"comment":""},{"name":"sqlite_autoindex_uniform_resource_1","type":"PRIMARY KEY","def":"PRIMARY KEY (uniform_resource_id)","table":"uniform_resource","referenced_table":null,"columns":["uniform_resource_id"],"referenced_columns":null,"comment":""},{"name":"-","type":"CHECK","def":"CHECK(json_valid(content_fm_body_attrs) OR content_fm_body_attrs IS NULL)","table":"uniform_resource","referenced_table":null,"columns":["content","content_fm_body_attrs"],"referenced_columns":null,"comment":""},{"name":"-","type":"CHECK","def":"CHECK(json_valid(frontmatter) OR frontmatter IS NULL)","table":"uniform_resource","referenced_table":null,"columns":["frontmatter"],"referenced_columns":null,"comment":""},{"name":"-","type":"CHECK","def":"CHECK(json_valid(elaboration) OR elaboration IS NULL)","table":"uniform_resource","referenced_table":null,"columns":["elaboration"],"referenced_columns":null,"comment":""}],"triggers":[],"def":"CREATE TABLE \"uniform_resource\" (\n    \"uniform_resource_id\" ULID PRIMARY KEY NOT NULL,\n    \"device_id\" ULID NOT NULL,\n    \"walk_session_id\" ULID NOT NULL,\n    \"walk_path_id\" ULID NOT NULL,\n    \"uri\" TEXT NOT NULL,\n    \"content_digest\" TEXT NOT NULL,\n    \"content\" BLOB,\n    \"nature\" TEXT,\n    \"size_bytes\" INTEGER,\n    \"last_modified_at\" INTEGER,\n    \"content_fm_body_attrs\" TEXT CHECK(json_valid(content_fm_body_attrs) OR content_fm_body_attrs IS NULL),\n    \"frontmatter\" TEXT CHECK(json_valid(frontmatter) OR frontmatter IS NULL),\n    \"elaboration\" TEXT CHECK(json_valid(elaboration) OR elaboration IS NULL),\n    \"created_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"created_by\" TEXT DEFAULT 'UNKNOWN',\n    \"updated_at\" TIMESTAMP,\n    \"updated_by\" TEXT,\n    \"deleted_at\" TIMESTAMP,\n    \"deleted_by\" TEXT,\n    \"activity_log\" TEXT,\n    FOREIGN KEY(\"device_id\") REFERENCES \"device\"(\"device_id\"),\n    FOREIGN KEY(\"walk_session_id\") REFERENCES \"ur_walk_session\"(\"ur_walk_session_id\"),\n    FOREIGN KEY(\"walk_path_id\") REFERENCES \"ur_walk_session_path\"(\"ur_walk_session_path_id\"),\n    UNIQUE(\"device_id\", \"content_digest\", \"uri\", \"size_bytes\", \"last_modified_at\")\n)"},{"name":"ur_walk_session_path_fs_entry","type":"table","comment":"Contains entries related to file system content walk paths. On multiple executions,  unlike uniform_resource, ur_walk_session_path_fs_entry rows are always inserted and   references the uniform_resource primary key of its related content.  This method allows for a more efficient query of file version differences across  sessions. With SQL queries, you can detect which sessions have a file added or modified,   which sessions have a file deleted, and what the differences are in file contents  if they were modified across sessions.","columns":[{"name":"ur_walk_session_path_fs_entry_id","type":"ULID","nullable":false,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isUlid\":true}"},{"name":"walk_session_id","type":"ULID","nullable":false,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isUlid\":true}"},{"name":"walk_path_id","type":"ULID","nullable":false,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isUlid\":true}"},{"name":"uniform_resource_id","type":"ULID","nullable":true,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isUlid\":true}"},{"name":"file_path_abs","type":"TEXT","nullable":false,"default":null,"comment":""},{"name":"file_path_rel_parent","type":"TEXT","nullable":false,"default":null,"comment":""},{"name":"file_path_rel","type":"TEXT","nullable":false,"default":null,"comment":""},{"name":"file_basename","type":"TEXT","nullable":false,"default":null,"comment":""},{"name":"file_extn","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"elaboration","type":"TEXT","nullable":true,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isJsonText\":true}"},{"name":"created_at","type":"TIMESTAMP","nullable":true,"default":"CURRENT_TIMESTAMP","comment":""},{"name":"created_by","type":"TEXT","nullable":true,"default":"'UNKNOWN'","comment":""},{"name":"updated_at","type":"TIMESTAMP","nullable":true,"default":null,"comment":""},{"name":"updated_by","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"deleted_at","type":"TIMESTAMP","nullable":true,"default":null,"comment":""},{"name":"deleted_by","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"activity_log","type":"TEXT","nullable":true,"default":null,"comment":"{\"isSqlDomainZodDescrMeta\":true,\"isJsonSqlDomain\":true}"}],"indexes":[{"name":"idx_ur_walk_session_path_fs_entry__walk_session_id__file_path_abs","def":"CREATE INDEX \"idx_ur_walk_session_path_fs_entry__walk_session_id__file_path_abs\" ON \"ur_walk_session_path_fs_entry\"(\"walk_session_id\", \"file_path_abs\")","table":"ur_walk_session_path_fs_entry","columns":["walk_session_id","file_path_abs"],"comment":""},{"name":"sqlite_autoindex_ur_walk_session_path_fs_entry_1","def":"PRIMARY KEY (ur_walk_session_path_fs_entry_id)","table":"ur_walk_session_path_fs_entry","columns":["ur_walk_session_path_fs_entry_id"],"comment":""}],"constraints":[{"name":"ur_walk_session_path_fs_entry_id","type":"PRIMARY KEY","def":"PRIMARY KEY (ur_walk_session_path_fs_entry_id)","table":"ur_walk_session_path_fs_entry","referenced_table":null,"columns":["ur_walk_session_path_fs_entry_id"],"referenced_columns":null,"comment":""},{"name":"- (Foreign key ID: 0)","type":"FOREIGN KEY","def":"FOREIGN KEY (uniform_resource_id) REFERENCES uniform_resource (uniform_resource_id) ON UPDATE NO ACTION ON DELETE NO ACTION MATCH NONE","table":"ur_walk_session_path_fs_entry","referenced_table":"uniform_resource","columns":["uniform_resource_id"],"referenced_columns":["uniform_resource_id"],"comment":""},{"name":"- (Foreign key ID: 1)","type":"FOREIGN KEY","def":"FOREIGN KEY (walk_path_id) REFERENCES ur_walk_session_path (ur_walk_session_path_id) ON UPDATE NO ACTION ON DELETE NO ACTION MATCH NONE","table":"ur_walk_session_path_fs_entry","referenced_table":"ur_walk_session_path","columns":["walk_path_id"],"referenced_columns":["ur_walk_session_path_id"],"comment":""},{"name":"- (Foreign key ID: 2)","type":"FOREIGN KEY","def":"FOREIGN KEY (walk_session_id) REFERENCES ur_walk_session (ur_walk_session_id) ON UPDATE NO ACTION ON DELETE NO ACTION MATCH NONE","table":"ur_walk_session_path_fs_entry","referenced_table":"ur_walk_session","columns":["walk_session_id"],"referenced_columns":["ur_walk_session_id"],"comment":""},{"name":"sqlite_autoindex_ur_walk_session_path_fs_entry_1","type":"PRIMARY KEY","def":"PRIMARY KEY (ur_walk_session_path_fs_entry_id)","table":"ur_walk_session_path_fs_entry","referenced_table":null,"columns":["ur_walk_session_path_fs_entry_id"],"referenced_columns":null,"comment":""},{"name":"-","type":"CHECK","def":"CHECK(json_valid(elaboration) OR elaboration IS NULL)","table":"ur_walk_session_path_fs_entry","referenced_table":null,"columns":["elaboration"],"referenced_columns":null,"comment":""}],"triggers":[],"def":"CREATE TABLE \"ur_walk_session_path_fs_entry\" (\n    \"ur_walk_session_path_fs_entry_id\" ULID PRIMARY KEY NOT NULL,\n    \"walk_session_id\" ULID NOT NULL,\n    \"walk_path_id\" ULID NOT NULL,\n    \"uniform_resource_id\" ULID,\n    \"file_path_abs\" TEXT NOT NULL,\n    \"file_path_rel_parent\" TEXT NOT NULL,\n    \"file_path_rel\" TEXT NOT NULL,\n    \"file_basename\" TEXT NOT NULL,\n    \"file_extn\" TEXT,\n    \"elaboration\" TEXT CHECK(json_valid(elaboration) OR elaboration IS NULL),\n    \"created_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"created_by\" TEXT DEFAULT 'UNKNOWN',\n    \"updated_at\" TIMESTAMP,\n    \"updated_by\" TEXT,\n    \"deleted_at\" TIMESTAMP,\n    \"deleted_by\" TEXT,\n    \"activity_log\" TEXT,\n    FOREIGN KEY(\"walk_session_id\") REFERENCES \"ur_walk_session\"(\"ur_walk_session_id\"),\n    FOREIGN KEY(\"walk_path_id\") REFERENCES \"ur_walk_session_path\"(\"ur_walk_session_path_id\"),\n    FOREIGN KEY(\"uniform_resource_id\") REFERENCES \"uniform_resource\"(\"uniform_resource_id\")\n)"},{"name":"fs_content_walk_session_stats_latest","type":"view","comment":"","columns":[{"name":"device_id","type":"ULID","nullable":true,"default":null,"comment":""},{"name":"walk_session_id","type":"ULID","nullable":true,"default":null,"comment":""},{"name":"walk_session_started_at","type":"TIMESTAMP","nullable":true,"default":null,"comment":""},{"name":"walk_session_finished_at","type":"TIMESTAMP","nullable":true,"default":null,"comment":""},{"name":"file_extension","type":"","nullable":true,"default":null,"comment":""},{"name":"walk_session_path_id","type":"ULID","nullable":true,"default":null,"comment":""},{"name":"walk_session_root_path","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"total_file_count","type":"","nullable":true,"default":null,"comment":""},{"name":"file_count_with_content","type":"","nullable":true,"default":null,"comment":""},{"name":"file_count_with_frontmatter","type":"","nullable":true,"default":null,"comment":""},{"name":"min_file_size_bytes","type":"","nullable":true,"default":null,"comment":""},{"name":"average_file_size_bytes","type":"INT","nullable":true,"default":null,"comment":""},{"name":"max_file_size_bytes","type":"","nullable":true,"default":null,"comment":""},{"name":"oldest_file_last_modified_datetime","type":"","nullable":true,"default":null,"comment":""},{"name":"youngest_file_last_modified_datetime","type":"","nullable":true,"default":null,"comment":""}],"indexes":[],"constraints":[],"triggers":[],"def":"CREATE VIEW \"fs_content_walk_session_stats_latest\" AS\n    SELECT fs.*\n      FROM fs_content_walk_session_stats AS fs\n      JOIN (  SELECT ur_walk_session.ur_walk_session_id AS latest_session_id\n                FROM ur_walk_session\n            ORDER BY ur_walk_session.walk_finished_at DESC\n               LIMIT 1) AS latest\n        ON fs.walk_session_id = latest.latest_session_id","referenced_tables":["fs_content_walk_session_stats","ur_walk_session"]},{"name":"fs_content_walk_session_stats","type":"view","comment":"","columns":[{"name":"device_id","type":"ULID","nullable":true,"default":null,"comment":""},{"name":"walk_session_id","type":"ULID","nullable":true,"default":null,"comment":""},{"name":"walk_session_started_at","type":"TIMESTAMP","nullable":true,"default":null,"comment":""},{"name":"walk_session_finished_at","type":"TIMESTAMP","nullable":true,"default":null,"comment":""},{"name":"file_extension","type":"","nullable":true,"default":null,"comment":""},{"name":"walk_session_path_id","type":"ULID","nullable":true,"default":null,"comment":""},{"name":"walk_session_root_path","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"total_file_count","type":"","nullable":true,"default":null,"comment":""},{"name":"file_count_with_content","type":"","nullable":true,"default":null,"comment":""},{"name":"file_count_with_frontmatter","type":"","nullable":true,"default":null,"comment":""},{"name":"min_file_size_bytes","type":"","nullable":true,"default":null,"comment":""},{"name":"average_file_size_bytes","type":"INT","nullable":true,"default":null,"comment":""},{"name":"max_file_size_bytes","type":"","nullable":true,"default":null,"comment":""},{"name":"oldest_file_last_modified_datetime","type":"","nullable":true,"default":null,"comment":""},{"name":"youngest_file_last_modified_datetime","type":"","nullable":true,"default":null,"comment":""}],"indexes":[],"constraints":[],"triggers":[],"def":"CREATE VIEW \"fs_content_walk_session_stats\" AS\n    WITH Summary AS (\n        SELECT\n            device.device_id AS device_id,\n            ur_walk_session.ur_walk_session_id AS walk_session_id,\n            ur_walk_session.walk_started_at AS walk_session_started_at,\n            ur_walk_session.walk_finished_at AS walk_session_finished_at,\n            COALESCE(ur_walk_session_path_fs_entry.file_extn, '') AS file_extension,\n            ur_walk_session_path.ur_walk_session_path_id as walk_session_path_id,\n            ur_walk_session_path.root_path AS walk_session_root_path,\n            COUNT(ur_walk_session_path_fs_entry.uniform_resource_id) AS total_file_count,\n            SUM(CASE WHEN uniform_resource.content IS NOT NULL THEN 1 ELSE 0 END) AS file_count_with_content,\n            SUM(CASE WHEN uniform_resource.frontmatter IS NOT NULL THEN 1 ELSE 0 END) AS file_count_with_frontmatter,\n            MIN(uniform_resource.size_bytes) AS min_file_size_bytes,\n            AVG(uniform_resource.size_bytes) AS average_file_size_bytes,\n            MAX(uniform_resource.size_bytes) AS max_file_size_bytes,\n            MIN(uniform_resource.last_modified_at) AS oldest_file_last_modified_datetime,\n            MAX(uniform_resource.last_modified_at) AS youngest_file_last_modified_datetime\n        FROM\n            ur_walk_session\n        JOIN\n            device ON ur_walk_session.device_id = device.device_id\n        LEFT JOIN\n            ur_walk_session_path ON ur_walk_session.ur_walk_session_id = ur_walk_session_path.walk_session_id\n        LEFT JOIN\n            ur_walk_session_path_fs_entry ON ur_walk_session_path.ur_walk_session_path_id = ur_walk_session_path_fs_entry.walk_path_id\n        LEFT JOIN\n            uniform_resource ON ur_walk_session_path_fs_entry.uniform_resource_id = uniform_resource.uniform_resource_id\n        GROUP BY\n            device.device_id,\n            ur_walk_session.ur_walk_session_id,\n            ur_walk_session.walk_started_at,\n            ur_walk_session.walk_finished_at,\n            ur_walk_session_path_fs_entry.file_extn,\n            ur_walk_session_path.root_path\n    )\n    SELECT\n        device_id,\n        walk_session_id,\n        walk_session_started_at,\n        walk_session_finished_at,\n        file_extension,\n        walk_session_path_id,\n        walk_session_root_path,\n        total_file_count,\n        file_count_with_content,\n        file_count_with_frontmatter,\n        min_file_size_bytes,\n        CAST(ROUND(average_file_size_bytes) AS INTEGER) AS average_file_size_bytes,\n        max_file_size_bytes,\n        oldest_file_last_modified_datetime,\n        youngest_file_last_modified_datetime\n    FROM\n        Summary\n    ORDER BY\n        device_id,\n        walk_session_finished_at,\n        file_extension","referenced_tables":["ur_walk_session","device","ur_walk_session_path","ur_walk_session_path_fs_entry","uniform_resource"]}],"relations":[{"table":"ur_walk_session","columns":["device_id"],"cardinality":"Zero or more","parent_table":"device","parent_columns":["device_id"],"parent_cardinality":"Exactly one","def":"FOREIGN KEY (device_id) REFERENCES device (device_id) ON UPDATE NO ACTION ON DELETE NO ACTION MATCH NONE","virtual":false},{"table":"ur_walk_session_path","columns":["walk_session_id"],"cardinality":"Zero or more","parent_table":"ur_walk_session","parent_columns":["ur_walk_session_id"],"parent_cardinality":"Exactly one","def":"FOREIGN KEY (walk_session_id) REFERENCES ur_walk_session (ur_walk_session_id) ON UPDATE NO ACTION ON DELETE NO ACTION MATCH NONE","virtual":false},{"table":"uniform_resource","columns":["walk_path_id"],"cardinality":"Zero or more","parent_table":"ur_walk_session_path","parent_columns":["ur_walk_session_path_id"],"parent_cardinality":"Exactly one","def":"FOREIGN KEY (walk_path_id) REFERENCES ur_walk_session_path (ur_walk_session_path_id) ON UPDATE NO ACTION ON DELETE NO ACTION MATCH NONE","virtual":false},{"table":"uniform_resource","columns":["walk_session_id"],"cardinality":"Zero or more","parent_table":"ur_walk_session","parent_columns":["ur_walk_session_id"],"parent_cardinality":"Exactly one","def":"FOREIGN KEY (walk_session_id) REFERENCES ur_walk_session (ur_walk_session_id) ON UPDATE NO ACTION ON DELETE NO ACTION MATCH NONE","virtual":false},{"table":"uniform_resource","columns":["device_id"],"cardinality":"Zero or more","parent_table":"device","parent_columns":["device_id"],"parent_cardinality":"Exactly one","def":"FOREIGN KEY (device_id) REFERENCES device (device_id) ON UPDATE NO ACTION ON DELETE NO ACTION MATCH NONE","virtual":false},{"table":"ur_walk_session_path_fs_entry","columns":["uniform_resource_id"],"cardinality":"Zero or more","parent_table":"uniform_resource","parent_columns":["uniform_resource_id"],"parent_cardinality":"Zero or one","def":"FOREIGN KEY (uniform_resource_id) REFERENCES uniform_resource (uniform_resource_id) ON UPDATE NO ACTION ON DELETE NO ACTION MATCH NONE","virtual":false},{"table":"ur_walk_session_path_fs_entry","columns":["walk_path_id"],"cardinality":"Zero or more","parent_table":"ur_walk_session_path","parent_columns":["ur_walk_session_path_id"],"parent_cardinality":"Exactly one","def":"FOREIGN KEY (walk_path_id) REFERENCES ur_walk_session_path (ur_walk_session_path_id) ON UPDATE NO ACTION ON DELETE NO ACTION MATCH NONE","virtual":false},{"table":"ur_walk_session_path_fs_entry","columns":["walk_session_id"],"cardinality":"Zero or more","parent_table":"ur_walk_session","parent_columns":["ur_walk_session_id"],"parent_cardinality":"Exactly one","def":"FOREIGN KEY (walk_session_id) REFERENCES ur_walk_session (ur_walk_session_id) ON UPDATE NO ACTION ON DELETE NO ACTION MATCH NONE","virtual":false}],"functions":null,"driver":{"name":"sqlite","database_version":"3.42.0","meta":{}}}
